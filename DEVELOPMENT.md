# 🚀 دليل التطوير - سند بوت

## 📋 كيف ينعكس التطوير على جميع الصفحات؟

### ✅ **ما ينعكس تلقائياً:**

#### **1. التخصيص والإعدادات:**
- **الاسم، الإيموجي، الصوت** - ينعكس فوراً (خلال 10 ثوان)
- **المعرفة والFAQ** - ينعكس فوراً
- **APIs** (Gladia, Gemini, ElevenLabs) - ينعكس فوراً

#### **2. تحديثات قاعدة البيانات:**
- أي تغيير في البيانات ينعكس فوراً على جميع المواقع

---

### 🔄 **ما يحتاج تدخل للانعكاس:**

#### **1. تغييرات في embed.js:**
- تغيير التصميم
- إضافة ميزات جديدة
- إصلاح bugs
- تحسين الأداء

#### **2. تغييرات في APIs:**
- routes جديدة
- تغيير في المنطق
- تحديث dependencies

---

## 🛠️ **خطوات التطوير:**

### **1. تطوير عادي:**
```bash
# تطوير البوت كالمعتاد
npm run dev
```

### **2. عند الانتهاء من التطوير:**
```bash
# تحديث رقم الإصدار
npm run update-embed

# النتيجة:
# ✅ Updated Sanad Bot version: 1.0.1 → 1.0.2
# 🔄 All embedded bots will detect this update within 5 minutes
```

### **3. التحقق من التحديث:**
- **المواقع المحلية:** تحديث تلقائي خلال 3 ثوان
- **المواقع الخارجية:** إشعار في console خلال 5 دقائق

---

## 📊 **نظام الإصدارات:**

### **تلقائي:**
- `1.0.0` → `1.0.1` → `1.0.2` (patch versions)
- يزيد تلقائياً مع كل `npm run update-embed`

### **يدوي (للتحديثات الكبيرة):**
```javascript
// في embed.js
const SANAD_BOT_VERSION = '2.0.0'; // تغيير يدوي
```

---

## 🔍 **مراقبة التحديثات:**

### **في console المتصفح:**
```
Sanad Bot v1.0.2 loading...
Sanad Bot v1.0.2 initialized successfully
🔄 New Sanad Bot version available: v1.0.3 (current: v1.0.2)
💡 Refresh the page to get the latest updates
```

### **للمطورين (localhost):**
```
🚀 Development mode: Auto-refresh in 3 seconds...
```

### **للمواقع الخارجية:**
```
🔔 To get the latest features and fixes, please refresh the page
```

---

## 🎯 **أفضل الممارسات:**

### **1. قبل النشر:**
```bash
# اختبار محلي
npm run dev

# تحديث الإصدار
npm run update-embed

# اختبار التضمين
# افتح external-test.html
```

### **2. للتحديثات الكبيرة:**
- غير رقم الإصدار يدوياً (مثل 2.0.0)
- اختبر جميع المواقع
- أعلم المستخدمين عن التحديث

### **3. للتحديثات الصغيرة:**
- استخدم `npm run update-embed`
- التحديث تلقائي خلال 5 دقائق

---

## 🔧 **استكشاف الأخطاء:**

### **البوت لا يتحدث في الموقع الخارجي:**
1. تحقق من console للأخطاء
2. تحقق من CORS headers
3. تحقق من Base URL

### **التحديثات لا تظهر:**
1. تحقق من رقم الإصدار في console
2. امسح cache المتصفح
3. تحقق من `/api/embed/version`

### **مشاكل في التطوير:**
1. تأكد من تشغيل `npm run dev`
2. تحقق من المنفذ 3000
3. تحقق من ملفات البيئة (.env.local)

---

## 📈 **مراقبة الأداء:**

### **APIs للمراقبة:**
- `/api/embed/version` - معلومات الإصدار
- `/api/bot/config/[agentId]` - تكوين البوت
- `/api/voice/process` - معالجة الصوت

### **Logs مهمة:**
- تحميل البوت وإصداره
- تحديثات التكوين
- أخطاء APIs

---

## 🎉 **النتيجة:**

**كل تطوير تقوم به ينعكس على جميع المواقع المضمن فيها البوت!**

- ✅ **تلقائياً:** التخصيص والبيانات
- 🔄 **بعد update-embed:** الكود والميزات الجديدة
- ⚡ **فوري:** في التطوير المحلي
- 🕐 **خلال 5 دقائق:** في المواقع الخارجية
